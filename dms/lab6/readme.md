# lab6

Exceptions

## init

* Выбирите СУБД `Oracle` для выполнения лабораторной.
* Оознакомтесь со скриптами создания и заполнения таблиц для выполнения
  лабораторной
  ([`lab1/create.sql`](https://github.com/Drapegnik/bsu/blob/master/dms/lab1/create.sql) + [`lab6/create.sql`](https://github.com/Drapegnik/bsu/blob/master/dms/lab6/create.sql)).
* База данных имеет дополнительную таблицу `T_ERROR`.
* Запустите скрипты на выполнение.

## task

1. Имеется `PL/SQL`-блок, содержащий следующие операторы:

   ```sql
   DECLARE
        empnum INTEGER;
   BEGIN
       INSERT INTO BONUS VALUES (505, 15, 2012, 500, NULL);
       INSERT INTO JOB VALUES (1010, 'Accountant xxxxxxxxxx', 5500);
       SELECT empno INTO empnum FROM EMP WHERE empno=505 OR empno=403;
   END;
   ```

   * Каждый из операторов исполняемого раздела вызывает предопределённое исключение со своими предопределёнными кодом и сообщением.
   * Дополните блок разделом обработки исключительных ситуаций.
   * Обработка каждой ситуации состоит в занесении в таблицу `T_ERROR` предопределённых кода ошибки, сообщения об ошибке и текущих даты и времени, когда ошибка произошла.

2. Создайте собственную исключительную ситуацию с кодом `-20000` и сообщением `January bonus greater February bonus` или `February bonus greater March bonus` в зависимости от месяца, данные за который вызвали ситуацию.

   * Исключительная ситуация наступает при нарушении бизнес-правила:

     > Сумма премий, начисленных в конкретном месяце `2017` года, не может быть меньше суммы премий, начисленных в предыдущий месяц этого же года.

   * Таким образом рассматриваются только январь, февраль и март `2017` года.
   * Внесите операторы, определяющие нарушение бизнес-правила и обработку соответсвующей ситуации в блок.
   * При наступлении пользователской исключительной ситуации обработка состоит в занесении данных о ней (аналогично пункту 1) в таблицу `T_ERROR`.

---

> results check out in
> [`lab6.sql`](https://github.com/Drapegnik/bsu/blob/master/dms/lab6/lab6.sql)
